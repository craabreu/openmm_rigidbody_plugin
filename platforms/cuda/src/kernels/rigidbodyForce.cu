real3 delta = make_real3(pos2.x-pos1.x, pos2.y-pos1.y, pos2.z-pos1.z);
real r = SQRT(delta.x*delta.x + delta.y*delta.y + delta.z*delta.z);
float2 bondParams = PARAMS[index];
real deltaIdeal = r-bondParams.x;
real deltaIdeal2 = deltaIdeal*deltaIdeal;
energy += bondParams.y*deltaIdeal2*deltaIdeal2;
real dEdR = 4*bondParams.y*deltaIdeal2*deltaIdeal;
dEdR = (r > 0) ? (dEdR/r) : 0;
delta *= dEdR;
real3 force1 = delta;
real3 force2 = -delta;
